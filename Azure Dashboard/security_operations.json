{
  "properties": {
    "lenses": {
      "0": {
        "order": 0,
        "parts": {
          "0": {
            "position": {
              "x": 0,
              "y": 0,
              "colSpan": 21,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\"> Security Operations Alert Dashboard</div>",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "1": {
            "position": {
              "x": 24,
              "y": 0,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Subscr
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\n| where TimeGenerated >= ago(14d)\n| where EventID == 4625 and AccountType == 'User'\n| extend Reason = case( SubStatus == '0xc0000064', 'User name does not exist',  SubStatus == '0xc000005e', 'No logon servers available to service the logon request',  SubStatus == '0xc0000062', 'Account name is not properly formatted',  SubStatus == '0xc0000064', 'Account name does not exist',  SubStatus == '0xc000006a', 'Incorrect password',  SubStatus == '0xc000006d', 'Bad user name or password',  SubStatus == '0xc000006f', 'User logon blocked by account restriction',  SubStatus == '0xc000006f', 'User logon outside of restricted logon hours',  SubStatus == '0xc0000070', 'User logon blocked by workstation restriction',  SubStatus == '0xc0000071', 'Password has expired',  SubStatus == '0xc0000072', 'Account is disabled',  SubStatus == '0xc0000133', 'Clocks between DC and other computer too far out of sync',  SubStatus == '0xc000015b', 'The user has not been granted the requested logon right at this machine',  SubStatus == '0xc0000193', 'Account has expirated',  SubStatus == '0xc0000224', 'User is required to change password at next logon',  SubStatus == '0xc0000234', 'Account is currently locked out',                         strcat('Unknown reason substatus: ', SubStatus))\n| summarize Count = count() by Reason//Username=TargetUserName, \n| where Reason !contains \"Unknown reason substatus\" \n"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Reason",
                      "type": "string"
                    },
                    "yAxis": [
                      {
                        "name": "Count",
                        "type": "long"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "PartId",
                  "value": "1ef80e9c-b030-4003-8e19-b0779c8424e5"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                },
                {
                  "name": "DashboardId",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Count of Failed Logon by Reason (Last 7 Days)",
                  "PartSubTitle": "Failed Logons",
                  "Query": "SecurityEvent\n| where TimeGenerated >= ago(1d)\n| where EventID == 4625 and AccountType == 'User'\n| extend Reason = case( SubStatus == '0xc0000064', 'User name does not exist',  SubStatus == '0xc000005e', 'No logon servers available to service the logon request',  SubStatus == '0xc0000062', 'Account name is not properly formatted',  SubStatus == '0xc0000064', 'Account name does not exist',  SubStatus == '0xc000006a', 'Incorrect password',  SubStatus == '0xc000006d', 'Bad user name or password',  SubStatus == '0xc000006f', 'User logon blocked by account restriction',  SubStatus == '0xc000006f', 'User logon outside of restricted logon hours',  SubStatus == '0xc0000070', 'User logon blocked by workstation restriction',  SubStatus == '0xc0000071', 'Password has expired',  SubStatus == '0xc0000072', 'Account is disabled',  SubStatus == '0xc0000133', 'Clocks between DC and other computer too far out of sync',  SubStatus == '0xc000015b', 'The user has not been granted the requested logon right at this machine',  SubStatus == '0xc0000193', 'Account has expirated',  SubStatus == '0xc0000224', 'User is required to change password at next logon',  SubStatus == '0xc0000234', 'Account is currently locked out',                         strcat('Unknown reason substatus: ', SubStatus))\n| summarize Count = count() by Reason//Username=TargetUserName, \n| where Reason !contains \"Unknown reason substatus\" \n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "local",
                    "granularity": "auto",
                    "relative": "7d"
                  }
                }
              }
            }
          },
          "2": {
            "position": {
              "x": 30,
              "y": 0,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Subs
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\n| where TimeGenerated >= ago(14d)\n| where EventID == 4625 and AccountType == 'User'\n| extend Reason = case( SubStatus == '0xc0000064', 'User name does not exist',  SubStatus == '0xc000005e', 'No logon servers available to service the logon request',  SubStatus == '0xc0000062', 'Account name is not properly formatted',  SubStatus == '0xc0000064', 'Account name does not exist',  SubStatus == '0xc000006a', 'Incorrect password',  SubStatus == '0xc000006d', 'Bad user name or password',  SubStatus == '0xc000006f', 'User logon blocked by account restriction',  SubStatus == '0xc000006f', 'User logon outside of restricted logon hours',  SubStatus == '0xc0000070', 'User logon blocked by workstation restriction',  SubStatus == '0xc0000071', 'Password has expired',  SubStatus == '0xc0000072', 'Account is disabled',  SubStatus == '0xc0000133', 'Clocks between DC and other computer too far out of sync',  SubStatus == '0xc000015b', 'The user has not been granted the requested logon right at this machine',  SubStatus == '0xc0000193', 'Account has expirated',  SubStatus == '0xc0000224', 'User is required to change password at next logon',  SubStatus == '0xc0000234', 'Account is currently locked out',                         strcat('Unknown reason substatus: ', SubStatus))\n//| summarize Count = count() by Username=TargetUserName, Reason=Reason0//\n//| where Reason !contains \"Unknown reason substatus\"\n| where Reason == \"Incorrect password\" \n| summarize Current_Week = countif(TimeGenerated >= ago(7d)), Previous_Week = countif(TimeGenerated < ago(7d)) by Username=TargetUserName\n| where Current_Week > Previous_Week\n| extend [\"Percent Increased\"] = iif(Previous_Week != 0, toreal(Current_Week)/toreal(Previous_Week), toreal(Current_Week))\n//| sort by growth desc nulls last\n//| project Username, Percent_Increased = toint(growth)\n"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Username",
                      "type": "string"
                    },
                    "yAxis": [
                      {
                        "name": "Percent Increased",
                        "type": "real"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "PartId",
                  "value": "6ac108a4-7d4d-4e4d-984e-2e10ede28df6"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                },
                {
                  "name": "DashboardId",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Incorrect Password (% Increase this week vs last)",
                  "PartSubTitle": "Failed Logons",
                  "Query": "SecurityEvent\n| where TimeGenerated >= ago(14d)\n| where EventID == 4625 and AccountType == 'User'\n| extend Reason = case( SubStatus == '0xc0000064', 'User name does not exist',  SubStatus == '0xc000005e', 'No logon servers available to service the logon request',  SubStatus == '0xc0000062', 'Account name is not properly formatted',  SubStatus == '0xc0000064', 'Account name does not exist',  SubStatus == '0xc000006a', 'Incorrect password',  SubStatus == '0xc000006d', 'Bad user name or password',  SubStatus == '0xc000006f', 'User logon blocked by account restriction',  SubStatus == '0xc000006f', 'User logon outside of restricted logon hours',  SubStatus == '0xc0000070', 'User logon blocked by workstation restriction',  SubStatus == '0xc0000071', 'Password has expired',  SubStatus == '0xc0000072', 'Account is disabled',  SubStatus == '0xc0000133', 'Clocks between DC and other computer too far out of sync',  SubStatus == '0xc000015b', 'The user has not been granted the requested logon right at this machine',  SubStatus == '0xc0000193', 'Account has expirated',  SubStatus == '0xc0000224', 'User is required to change password at next logon',  SubStatus == '0xc0000234', 'Account is currently locked out',strcat('Unknown reason substatus: ', SubStatus))\n| where Reason == \"Incorrect password\" \n| summarize Current_Week = countif(TimeGenerated >= ago(7d)), Previous_Week = countif(TimeGenerated < ago(7d)) by Username=TargetUserName\n| where Current_Week > Previous_Week\n| extend [\"Percent Increased\"] = iif(Previous_Week != 0, toreal(Current_Week)/toreal(Previous_Week), toreal(Current_Week))"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "local",
                    "granularity": "auto",
                    "relative": "30d"
                  }
                }
              }
            }
          },
          "3": {
            "position": {
              "x": 0,
              "y": 1,
              "colSpan": 5,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Subscri
                  }
                },
                {
                  "name": "Query",
                  "value": "SigninLogs\n//Removes Empty Location (IPV6 Addresses)\n| where isnotempty(Location)\n//Removes aaa Office Locations (US, Puerto Rico, Guam, Virgin Islands)\n| where Location !~ \"US\"\n| where Location !~ \"PR\"\n| where Location !~ \"GU\"\n| where Location !~ \"VI\"\n| where Location !~ \"MP\"\n//Removes the AT&T Identified IP Space\n| where IPAddress !has \"32.66.194.\"\n//Removes the Verizon (Guam) Mobile IP Space\n| where IPAddress !has \"8.3.112.\"\n| where IPAddress !has \"8.3.123.\"\n| parse DeviceDetail with * '\"operatingSystem\":\"'OperatingSystem'\"' *\n| parse DeviceDetail with * '\"browser\":\"'Browser'\"' *\n| extend AccountCustomEntity = UserDisplayName\n| extend IPCustomEntity = IPAddress\n| summarize count() by UserDisplayName, IPAddress \n//| project TimeGenerated, OperationName, UserDisplayName, OperatingSystem, Browser, IPAddress, Location, Status\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P7D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "UserDisplayName",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [
                      {
                        "name": "IPAddress",
                        "type": "String"
                      }
                    ],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/
                },
                {
                  "name": "PartId",
                  "value": "fcd0e178-87bc-4b62-bfbb-ebf88a84f46a"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Foreign Sign-in Attempts",
                  "PartSubTitle": "Past 30 Days"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "30d"
                  }
                }
              }
            }
          },
          "4": {
            "position": {
              "x": 5,
              "y": 1,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Subscription"
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\r\n| where EventID in (4624, 4625)\r\n| where AccountType == \"User\" \r\n| summarize Amount = dcount(Account) by LogonTypeName\r\n| sort by Amount\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "LogonTypeName",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "Amount",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/su"
                },
                {
                  "name": "PartId",
                  "value": "e4240b18-551f-4a56-951a-91caacbac96f"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "GroupedBar"
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Account Logons by Types",
                  "PartSubTitle": "Past 24 Hrs."
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "5": {
            "position": {
              "x": 11,
              "y": 1,
              "colSpan": 10,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Subscri
                  }
                },
                {
                  "name": "Query",
                  "value": "//this is a techniques attackers use to hide the usage of commands on a system to avoid detection. While there are certainly methods to avoid even showing up on the commandline, the obfuscation technique used below is regularly used by various levels of attackers.\r\n//Below we will decode a base64 encoded string in the command line data and look for common PowerShell methods that are used in attacks.\r\nSecurityEvent\r\n| where TimeGenerated >= ago(30d)\r\n| where Process contains \"powershell.exe\" and CommandLine contains \" -enc\"\r\n|extend b64 = extract(\"[A-Za-z0-9|+|=|/]{30,}\", 0,CommandLine)\r\n|extend utf8_decode=base64_decodestring(b64)\r\n|extend decode =  replace (\"\\x00\",\"\", utf8_decode)\r\n|where decode contains 'Gzip' or decode contains 'IEX' or decode contains 'Invoke' or decode contains '.MemoryStream' or decode contains '7zip' or decode contains 'LsaIso.exe' //Credential Guard = LsaIso.exe\r\n| summarize by Computer, Account, decode, CommandLine\r\n//the results provide you with details about what was in the encoded command line and potentially what an attacker was attempting to do.\r\n//| where TimeGenerated == todatetime('2019-02-24T00:00:00Z')\r\n"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscrip
                },
                {
                  "name": "PartId",
                  "value": "75b37ade-038b-458c-9382-71a8c5053838"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Encoded PowerShell Activity",
                  "PartSubTitle": "Past 30 Days",
                  "GridColumnsWidth": {
                    "Computer": "177px",
                    "Account": "158px",
                    "decode": "246px",
                    "CommandLine": "368px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "30d"
                  }
                }
              }
            }
          },
          "6": {
            "position": {
              "x": 24,
              "y": 4,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Subscri
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\r\n| where TimeGenerated >= ago(14d)\r\n| where EventID == 4625 and AccountType == 'User'\r\n| extend Reason = case( SubStatus == '0xc0000064', 'User name does not exist',  SubStatus == '0xc000005e', 'No logon servers available to service the logon request',  SubStatus == '0xc0000062', 'Account name is not properly formatted',  SubStatus == '0xc0000064', 'Account name does not exist',  SubStatus == '0xc000006a', 'Incorrect password',  SubStatus == '0xc000006d', 'Bad user name or password',  SubStatus == '0xc000006f', 'User logon blocked by account restriction',  SubStatus == '0xc000006f', 'User logon outside of restricted logon hours',  SubStatus == '0xc0000070', 'User logon blocked by workstation restriction',  SubStatus == '0xc0000071', 'Password has expired',  SubStatus == '0xc0000072', 'Account is disabled',  SubStatus == '0xc0000133', 'Clocks between DC and other computer too far out of sync',  SubStatus == '0xc000015b', 'The user has not been granted the requested logon right at this machine',  SubStatus == '0xc0000193', 'Account has expirated',  SubStatus == '0xc0000224', 'User is required to change password at next logon',  SubStatus == '0xc0000234', 'Account is currently locked out',strcat('Unknown reason substatus: ', SubStatus))\r\n| where Reason == \"User name does not exist\" \r\n| summarize Current_Week = countif(TimeGenerated >= ago(7d)), Previous_Week = countif(TimeGenerated < ago(7d)) by Username=TargetUserName\r\n| where Current_Week > Previous_Week\r\n| extend [\"Percent Increased\"] = iif(Previous_Week != 0, toreal(Current_Week)/toreal(Previous_Week), toreal(Current_Week))\n"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Username",
                      "type": "string"
                    },
                    "yAxis": [
                      {
                        "name": "Percent Increased",
                        "type": "real"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "PartId",
                  "value": "510e2560-fe4d-4575-a2e8-ddec5b7fc59e"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                },
                {
                  "name": "DashboardId",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Username Does Not Exist (% Increase this week vs last) ",
                  "PartSubTitle": "Failed Logons"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "local",
                    "granularity": "auto",
                    "relative": "30d"
                  }
                }
              }
            }
          },
          "7": {
            "position": {
              "x": 30,
              "y": 4,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Subscrip
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\r\n| where TimeGenerated >= ago(14d)\r\n| where EventID == 4625 and AccountType == 'User'\r\n| extend Reason = case( SubStatus == '0xc0000064', 'User name does not exist',  SubStatus == '0xc000005e', 'No logon servers available to service the logon request',  SubStatus == '0xc0000062', 'Account name is not properly formatted',  SubStatus == '0xc0000064', 'Account name does not exist',  SubStatus == '0xc000006a', 'Incorrect password',  SubStatus == '0xc000006d', 'Bad user name or password',  SubStatus == '0xc000006f', 'User logon blocked by account restriction',  SubStatus == '0xc000006f', 'User logon outside of restricted logon hours',  SubStatus == '0xc0000070', 'User logon blocked by workstation restriction',  SubStatus == '0xc0000071', 'Password has expired',  SubStatus == '0xc0000072', 'Account is disabled',  SubStatus == '0xc0000133', 'Clocks between DC and other computer too far out of sync',  SubStatus == '0xc000015b', 'The user has not been granted the requested logon right at this machine',  SubStatus == '0xc0000193', 'Account has expirated',  SubStatus == '0xc0000224', 'User is required to change password at next logon',  SubStatus == '0xc0000234', 'Account is currently locked out',strcat('Unknown reason substatus: ', SubStatus))\r\n| where Reason == \"Account is disabled\"\r\n| summarize Current_Week = countif(TimeGenerated >= ago(7d)), Previous_Week = countif(TimeGenerated < ago(7d)) by Username=TargetUserName\r\n| where Current_Week > Previous_Week\r\n| extend [\"Percent Increased\"] = iif(Previous_Week != 0, toreal(Current_Week)/toreal(Previous_Week), toreal(Current_Week))\n"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Username",
                      "type": "string"
                    },
                    "yAxis": [
                      {
                        "name": "Percent Increased",
                        "type": "real"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "PartId",
                  "value": "3eac71e2-cc83-43a0-adf3-566d810553a2"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                },
                {
                  "name": "DashboardId",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Disabled Account (% Increase this week vs last)",
                  "PartSubTitle": "Failed Logons"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "local",
                    "granularity": "auto",
                    "relative": "30d"
                  }
                }
              }
            }
          },
          "8": {
            "position": {
              "x": 0,
              "y": 5,
              "colSpan": 5,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Subscrip
                  }
                },
                {
                  "name": "Query",
                  "value": "AuditLogs\r\n//Set Time Frame\r\n| where TimeGenerated > ago(24h)\r\n| where OperationName == \"Add user\"\r\n| parse TargetResources with * '\"userPrincipalName\":\"'TUsername'\"' *\r\n//Summarizes Count \r\n| summarize count() by TUsername, Result\r\n| extend AccountCustomEntity = TUsername\r\n//Removes Additional Catagory\r\n| project-away AccountCustomEntity\n"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subs
                },
                {
                  "name": "PartId",
                  "value": "d4d0bda9-e0ec-4e76-b312-3ad27ab2d881"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "User Accounts Added",
                  "PartSubTitle": "Past 24 Hrs.",
                  "Query": "AuditLogs\n//Set Time Frame\n| where TimeGenerated > ago(24h)\n| where OperationName == \"Add user\"\n| where Result != \"failure\"\n| parse TargetResources with * '\"userPrincipalName\":\"'TUsername'\"' *\n//Summarizes Count \n| summarize count() by TUsername, Result\n| extend AccountCustomEntity = TUsername\n//Removes Additional Catagory\n| project-away AccountCustomEntity",
                  "GridColumnsWidth": {
                    "TUsername": "277px",
                    "Result": "93px",
                    "count_": "228px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "24h"
                  }
                }
              }
            }
          },
          "9": {
            "position": {
              "x": 5,
              "y": 5,
              "colSpan": 10,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Subscriptd"
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\r\n| where EventID == \"6416\"\r\n| where ClassName == \"USB\"\r\n| where DeviceDescription contains \"Storage\"\r\n| summarize count() by Account, Computer, DeviceDescription, DeviceId\r\n| sort by count_\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/sub
                },
                {
                  "name": "PartId",
                  "value": "ede5aeba-6a94-4b79-a403-579a5ddd2bb2"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "USB Storage Devices Detected",
                  "PartSubTitle": "Past 24 Hrs.",
                  "GridColumnsWidth": {
                    "Account": "153px",
                    "Computer": "164px",
                    "DeviceDescription": "170px",
                    "DeviceId": "285px",
                    "count_": "170px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "24h"
                  }
                }
              }
            }
          },
          "10": {
            "position": {
              "x": 15,
              "y": 5,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Subsc
                  }
                },
                {
                  "name": "Query",
                  "value": "let ProcessCreationEvents=() {\r\nlet processEvents=SecurityEvent\r\n| where EventID==4688\r\n| project  EventTime=TimeGenerated, ComputerName=Computer,AccountName=SubjectUserName,        AccountDomain=SubjectDomainName,\r\nFileName=reverse(substring(reverse(NewProcessName), 0, indexof(reverse(NewProcessName), \"\\\\\"))),\r\nProcessCommandLine = CommandLine, \r\nFolderPath = \"\",\r\nInitiatingProcessFileName=ParentProcessName,InitiatingProcessCommandLine=\"\",InitiatingProcessParentFileName=\"\";\r\nprocessEvents};\r\nProcessCreationEvents\r\n| where FileName == 'net.exe' and AccountName != \"\" and ProcessCommandLine !contains '\\\\'  and ProcessCommandLine !contains '/add' \r\n| where (ProcessCommandLine contains ' user ' or ProcessCommandLine contains ' group ') and (ProcessCommandLine endswith ' /do' or ProcessCommandLine endswith ' /domain') \r\n| extend Target = extract(\"(?i)[user|group] (\\\"*[a-zA-Z0-9-_ ]+\\\"*)\", 1, ProcessCommandLine) | filter Target  != '' \r\n| project AccountName, Target, ProcessCommandLine, ComputerName  \r\n| sort by AccountName, Target\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P7D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/s"
                },
                {
                  "name": "PartId",
                  "value": "cda115b1-8d31-4e2b-9c5e-a78227095142"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Account Enumeration",
                  "PartSubTitle": "Past 7 Days",
                  "GridColumnsWidth": {
                    "AccountName": "93px",
                    "Target": "86px",
                    "ProcessCommandLine": "223px",
                    "ComputerName": "263px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "7d"
                  }
                }
              }
            }
          },
          "11": {
            "position": {
              "x": 0,
              "y": 9,
              "colSpan": 21,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\"> Network Based IDPS Dashboard</div>\n",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "12": {
            "position": {
              "x": 0,
              "y": 10,
              "colSpan": 9,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Sub
                  }
                },
                {
                  "name": "Query",
                  "value": "search *\r\n| where TimeGenerated > ago(1d) \r\n| summarize Log_Count = count() by $table\r\n| render barchart\n"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "$table",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "Log_Count",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/su
                },
                {
                  "name": "PartId",
                  "value": "9a9f10f7-d9de-40c9-8088-54e25fa329e9"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "Bar"
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Incoming Log Count",
                  "PartSubTitle": "Past 24 Hrs.",
                  "Query": "search *\n| where TimeGenerated > ago(1d) \n| summarize Log_Count = count() by $table\n| sort by Log_Count desc \n| render barchart\n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "24h"
                  }
                }
              }
            }
          },
          "13": {
            "position": {
              "x": 9,
              "y": 10,
              "colSpan": 4,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Subsc
                  }
                },
                {
                  "name": "Query",
                  "value": "WireData\r\n| where LocalIP startswith \"192.168.\"\r\n| summarize count() by Computer, LocalIP\r\n| project-away count_ | sort by Computer\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscr"
                },
                {
                  "name": "PartId",
                  "value": "8edde00d-e1e8-4672-9019-ed184c46f263"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "aaa Hosts on the 192.168.x.x Network",
                  "PartSubTitle": "Past 24 Hrs.",
                  "GridColumnsWidth": {
                    "Computer": "183px",
                    "LocalIP": "282px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "24h"
                  }
                }
              }
            }
          },
          "14": {
            "position": {
              "x": 13,
              "y": 10,
              "colSpan": 8,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "S
                  }
                },
                {
                  "name": "Query",
                  "value": "Event\n| where (EventLevelName == \"Error\")\n| where (TimeGenerated > ago(1days))\n| summarize ErrorCount = count() by Computer\n| top 10 by ErrorCount desc\n"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Computer",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "ErrorCount",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subsc
                },
                {
                  "name": "PartId",
                  "value": "6cd9dfd4-a8b7-42ce-a245-84ca7f960b95"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "Bar"
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Top 10 Systems Identified with Errors",
                  "PartSubTitle": "Past 24 Hrs."
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "24h"
                  }
                }
              }
            }
          },
          "15": {
            "position": {
              "x": 0,
              "y": 15,
              "colSpan": 21,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\"> Host Based IDPS Dashboard</div>\n",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "16": {
            "position": {
              "x": 0,
              "y": 16,
              "colSpan": 5,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Sub
                  }
                },
                {
                  "name": "Query",
                  "value": "ProtectionStatus\r\n| summarize dcount(Computer) by TypeofProtection\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "TypeofProtection",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "dcount_Computer",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscri
                },
                {
                  "name": "PartId",
                  "value": "5564daff-ee91-43da-a7fa-43fba573675b"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "AV Protection Counts by Type",
                  "PartSubTitle": "Past 7 Days"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "7d"
                  }
                }
              }
            }
          },
          "17": {
            "position": {
              "x": 5,
              "y": 16,
              "colSpan": 8,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Subscr
                  }
                },
                {
                  "name": "Query",
                  "value": "ProtectionStatus\r\n| where TypeofProtection == \"No Anti-Malware Tool was detected\"\r\n| summarize count() by Computer, ProtectionStatus, ThreatStatus, TypeofProtection\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/s
                },
                {
                  "name": "PartId",
                  "value": "f48c0efd-8a05-4d73-a0b3-ff61c54100de"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Hosts without AV Protection",
                  "PartSubTitle": "Past 24 Hrs.",
                  "GridColumnsWidth": {
                    "Computer": "139px",
                    "ProtectionStatus": "120px",
                    "ThreatStatus": "97px",
                    "TypeofProtection": "253px",
                    "count_": "201px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "7d"
                  }
                }
              }
            }
          },
          "18": {
            "position": {
              "x": 13,
              "y": 16,
              "colSpan": 8,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "
                  }
                },
                {
                  "name": "Query",
                  "value": "//List machines running Microsoft Defender ATP service\r\nlet c = CounterACT_SWAM_CL\r\n| where Windows_Processes_Running_s != \"\"\r\n| extend Windows_Processes_Running= split(Windows_Processes_Running_s, \", \")\r\n| mvexpand Windows_Processes_Running\r\n| where Windows_Processes_Running == \"mssense\"\r\n| summarize Last_Time_Service_Detected=max(TimeGenerated) by DNSName=iff(NetBIOS_Hostname_s==\"\", tolower(DNS_Name_s),strcat(tolower(NetBIOS_Hostname_s), \".aaa.gov\"));//, IPv4_Address_s, MAC_Address_s\r\n//List machines CounterAct has detected on the network\r\nlet d = CounterACT_HWAM_CL \r\n//| where TimeGenerated  > ago(7d)\r\n| extend Host1 = iff(802_1x_Host_Name_s==\"\", NetBIOS_Hostname_s, 802_1x_Host_Name_s) \r\n| extend HostName = iff(Host1==\"\", toupper(trim(\".aaa.gov\",DNS_Name_s)), Host1) \r\n| summarize max(TimeGenerated) by HostName\r\n| where HostName !=\"\"\r\n| project Last_Detected_On_Network=max_TimeGenerated, DNSName=strcat(tolower(HostName), \".aaa.gov\");\r\n//List machines CounterAct has detected on the network that have stopped reporting to the Microsoft Defender ATP service\r\nc | join kind=fullouter d on DNSName\r\n| where isnotempty(Last_Time_Service_Detected)\r\n| project-away DNSName1\r\n| sort by Last_Time_Service_Detected asc\r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "PartId",
                  "value": "15369a4a-e14f-4ba5-8ba0-ab80e4ad56a8"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "DashboardId",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Windows Defender ATP service stopped running",
                  "PartSubTitle": "CounterAct",
                  "Query": "//List machines running Microsoft Defender ATP service\nlet c = CounterACT_SWAM_CL\n| where TimeGenerated  > ago(30d)\n| where Windows_Processes_Running_s != \"\"\n| extend Windows_Processes_Running= split(Windows_Processes_Running_s, \", \")\n| mvexpand Windows_Processes_Running\n| where Windows_Processes_Running == \"mssense\"\n| summarize Last_Time_Service_Detected=max(TimeGenerated) by DNSName=iff(NetBIOS_Hostname_s==\"\", tolower(DNS_Name_s),strcat(tolower(NetBIOS_Hostname_s), \".aaa.gov\"));\n//List machines CounterAct has detected on the network\nlet d = CounterACT_SWAM_CL\n| where TimeGenerated  > ago(30d)\n| where Windows_Processes_Running_s != \"\"\n| summarize Last_Services_Pull=max(TimeGenerated) by DNSName=iff(NetBIOS_Hostname_s==\"\", tolower(DNS_Name_s),strcat(tolower(NetBIOS_Hostname_s), \".aaa.gov\"));\n//List machines CounterAct has detected on the network that have stopped reporting to the Microsoft Defender ATP service\nc\n| join kind=fullouter\n    d\non DNSName\n| where isnotempty(Last_Time_Service_Detected)\n| where Last_Time_Service_Detected < Last_Services_Pull\n| extend [\"Days Undetected\"] = datetime_diff('day', Last_Services_Pull, Last_Time_Service_Detected)\n| project DNSName=iff(isempty(DNSName), DNSName1, DNSName), [\"Days Undetected\"] , Last_Time_Service_Detected, Last_Services_Pull\n| sort by Last_Services_Pull desc",
                  "GridColumnsWidth": {
                    "IPv4_Address_s": "116px",
                    "DNSName": "193px",
                    "Last_Time_Service_Detected": "201px",
                    "Last_Detected_On_Network": "179px",
                    "Machine_Detected_On_Network": "322px",
                    "Days Undetected": "124px",
                    "Last_Services_Pull": "162px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "1h",
                    "relative": "30d"
                  }
                }
              }
            }
          },
          "19": {
            "position": {
              "x": 0,
              "y": 20,
              "colSpan": 5,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                 
                  }
                },
                {
                  "name": "Query",
                  "value": "ProtectionStatus\r\n| where ProtectionStatus == \"Signatures out of date\"\r\n| project  DeviceName , ThreatStatus , TypeofProtection , ProtectionStatusDetails\r\n| summarize count() by ThreatStatus , TypeofProtection\r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "ThreatStatus",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [
                      {
                        "name": "TypeofProtection",
                        "type": "String"
                      }
                    ],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/
                },
                {
                  "name": "PartId",
                  "value": "69fe5c01-561f-423b-ac21-b95b751bb32b"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "Bar"
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Threat Status Count",
                  "PartSubTitle": "Past 3 Days",
                  "Query": "ProtectionStatus\n| where ProtectionStatus == \"Signatures out of date\"\n| project  DeviceName , ThreatStatus , TypeofProtection , ProtectionStatusDetails\n| summarize count() by ThreatStatus , TypeofProtection"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "3d"
                  }
                }
              }
            }
          },
          "20": {
            "position": {
              "x": 5,
              "y": 20,
              "colSpan": 7,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    
                  }
                },
                {
                  "name": "Query",
                  "value": "ProtectionStatus\r\n| where ThreatStatus !in (\"No threats detected\", \"Unknown\")\r\n| extend HostCustomEntity = DeviceName\r\n| extend IPCustomEntity = ComputerIP_Hidden\r\n| summarize count() by DeviceName, Threat, ThreatStatus, TypeofProtection\r\n| sort by count_ desc nulls last\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P7D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/
                },
                {
                  "name": "PartId",
                  "value": "9b177982-d0ca-4169-828f-8e9052148ad7"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Anti-Virus Alerts",
                  "PartSubTitle": "Past 24 Hrs.",
                  "GridColumnsWidth": {
                    "DeviceName": "166px",
                    "ThreatStatus": "99px",
                    "Threat": "175px",
                    "TypeofProtection": "216px",
                    "count_": "175px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "24h"
                  }
                }
              }
            }
          },
          "21": {
            "position": {
              "x": 12,
              "y": 20,
              "colSpan": 9,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    
                  }
                },
                {
                  "name": "Query",
                  "value": "ProtectionStatus\r\n| where ProtectionStatusDetails contains \"Signatures older than 7 days\"\r\n| summarize count() by DeviceName, ThreatStatus, ProtectionStatus, SignatureVersion\r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/
                },
                {
                  "name": "PartId",
                  "value": "1fca523b-5936-4b49-af65-982e5efa6206"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Signatures Out of Date",
                  "PartSubTitle": "Past 24 Hrs.",
                  "Query": "ProtectionStatus\n| where ProtectionStatusDetails contains \"Signatures older than 7 days\"\n| summarize count() by DeviceName, ThreatStatus, ProtectionStatus, SignatureVersion\n| sort by SignatureVersion\n",
                  "GridColumnsWidth": {
                    "ThreatStatus": "177px",
                    "SignatureVersion": "148px",
                    "DeviceName": "186px",
                    "ProtectionStatus": "163px",
                    "count_": "247px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "24h"
                  }
                }
              }
            }
          },
          "22": {
            "position": {
              "x": 0,
              "y": 25,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                 
                  }
                },
                {
                  "name": "Query",
                  "value": "WDATP_MachineInventory_CL\n| where healthStatus_s <> \"Active\"\n| extend DNSName=tolower(computerDnsName_s)\n| project TimeGenerated, DNSName, healthStatus_s, rbacGroupName_s\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P7D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "PartId",
                  "value": "02cc7998-c1ed-4e76-bd10-97af08068d5a"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "DashboardId",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Devices with Non-Active Health Status",
                  "PartSubTitle": "Windows Defender ATP",
                  "GridColumnsWidth": {
                    "healthStatus_s": "163px",
                    "TimeGenerated": "141px",
                    "DNSName": "193px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "1h",
                    "relative": "7d"
                  }
                }
              }
            }
          },
          "23": {
            "position": {
              "x": 6,
              "y": 25,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "Su
                  }
                },
                {
                  "name": "Query",
                  "value": "ProtectionStatus  \n| where ProtectionStatus == \"Not Reporting\" or ProtectionStatus == \"No real time protection\" \n| where TypeofProtection == \"Windows Defender\" \n| extend DNSName=tolower(DeviceName)\n| project TimeGenerated, SourceComputerId, DNSName, ProtectionStatus, ProtectionStatusDetails, TypeofProtection\n"
                },
                {
                  "name": "TimeRange",
                  "value": "2019-10-01T14:29:11.000Z/2019-10-31T14:29:11.762Z"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "PartId",
                  "value": "a74ddec1-6124-45c1-8aa2-32ae323abfaf"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "DashboardId",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Defender Not Reporting or with No Real Time Protection",
                  "PartSubTitle": "Windows Defender ATP",
                  "Query": "ProtectionStatus  \n| where ProtectionStatus == \"Not Reporting\" or ProtectionStatus == \"No real time protection\" \n| where TypeofProtection == \"Windows Defender\" \n| extend DNSName=tolower(DeviceName)\n| project TimeGenerated, DNSName, ProtectionStatus, ProtectionStatusDetails, TypeofProtection\n",
                  "GridColumnsWidth": {
                    "TimeGenerated": "140px",
                    "ProtectionStatus": "140px",
                    "ProtectionStatusDetails": "752px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "1h",
                    "relative": "7d"
                  }
                }
              }
            }
          },
          "24": {
            "position": {
              "x": 12,
              "y": 25,
              "colSpan": 9,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "
                  }
                },
                {
                  "name": "Query",
                  "value": "//Devices with a Protection status or in Windows Defender Inventory in past 7 days\nlet a = ProtectionStatus | where TimeGenerated > ago(7d) | extend DNSName=tolower(trim(\".aaa.gov\", DeviceName))\n| summarize count() by DNSName;\nlet b = WDATP_MachineInventory_CL | where TimeGenerated > ago(7d) | extend DNSName=tolower(trim(\".aaa.gov\", computerDnsName_s))\n| summarize count() by DNSName;\nlet c = a | join kind= fullouter b on DNSName | project DNSName=iff(isempty(DNSName), DNSName1, DNSName);\n//Devices CounterAct identified as having a Windows OS in last 7 days\nlet d = CounterACT_HWAM_CL | where TimeGenerated > ago(7d)\n| extend Host1 = iff(802_1x_Host_Name_s==\"\", NetBIOS_Hostname_s, 802_1x_Host_Name_s) | extend Host2 = iff(Host1==\"\", toupper(trim(\".aaa.gov\",DNS_Name_s)), Host1) | extend DNSName = tolower(Host2)| where isnotempty(DNSName)\n| where Operating_System_s contains \"Windows\" or Windows_Version_s contains \"Windows\" | extend OS=iff(isempty(Windows_Version_s), Operating_System_s, Windows_Version_s)\n| summarize [\"Last Detected\"]=max(TimeGenerated) by DNSName, OS;\nc | join kind= fullouter d on DNSName | where isempty(DNSName) | project [\"Host Name\"]= DNSName1, [\"Operating System\"]=OS, [\"Last Detected\"], [\"Protection Status\"]=\"None\"\n//| summarize count() by [\"Operating System\"]\n| sort by [\"Host Name\"] asc\n"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "PartId",
                  "value": "7af19006-675d-425f-8e68-a29868411a9c"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                },
                {
                  "name": "DashboardId",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "CounterAct Detected Devices with no Protection Status",
                  "PartSubTitle": "Past 7 Days",
                  "Query": "//Devices with a Protection status or in Windows Defender Inventory in past 7 days\nlet a = ProtectionStatus | where TimeGenerated > ago(7d) | extend DNSName=tolower(trim(\".aaa.gov\", DeviceName))\n| summarize count() by DNSName;\nlet b = WDATP_MachineInventory_CL | where TimeGenerated > ago(7d) | extend DNSName=tolower(trim(\".aaa.gov\", computerDnsName_s))\n| summarize count() by DNSName;\nlet c = a | join kind= fullouter b on DNSName | project DNSName=iff(isempty(DNSName), DNSName1, DNSName);\n//Devices CounterAct identified with an OS in last 7 days\nlet d = CounterACT_HWAM_CL | where TimeGenerated > ago(7d)\n| extend Host1 = iff(802_1x_Host_Name_s==\"\", NetBIOS_Hostname_s, 802_1x_Host_Name_s) | extend Host2 = iff(Host1==\"\", toupper(trim(\".aaa.gov\",DNS_Name_s)), Host1) | extend DNSName = tolower(Host2)| where isnotempty(DNSName)\n| where isnotempty(Operating_System_s) or isnotempty(Windows_Version_s) | extend OS=iff(isempty(Windows_Version_s), Operating_System_s, Windows_Version_s)\n| summarize [\"Last Detected\"]=max(TimeGenerated) by DNSName, OS;\nc | join kind= fullouter d on DNSName | where isempty(DNSName) | project [\"Host Name\"]= DNSName1, [\"Operating System\"]=OS, [\"Last Detected\"], [\"Protection Status\"]=\"None\"\n//| summarize count() by [\"Operating System\"]\n| sort by [\"Operating System\"] desc\n",
                  "GridColumnsWidth": {
                    "Host Name": "179px",
                    "Operating System": "309px",
                    "Last Detected": "145px",
                    "Protection Status": "183px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "1h",
                    "relative": "7d"
                  }
                }
              }
            }
          },
          "25": {
            "position": {
              "x": 0,
              "y": 29,
              "colSpan": 21,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\"> Patch & Vulnerability Management Dashboard</div>\n",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "26": {
            "position": {
              "x": 0,
              "y": 30,
              "colSpan": 5,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "
                  }
                },
                {
                  "name": "Query",
                  "value": "//Critical Vulnerabilities by OS\r\nUpdateSummary\r\n| where TimeGenerated > ago(30d) \r\n| where CriticalUpdatesMissing != \"0\" \r\n    and OldestMissingSecurityUpdateInDays > 30\r\n| summarize count() by OsVersion\n"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/
                },
                {
                  "name": "PartId",
                  "value": "f1951ba9-f7ec-4712-b230-b847fd661e88"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Hosts with Critical Vulnerabilities",
                  "PartSubTitle": "Greater than 30 Days",
                  "Query": "//Critical Vulnerabilities by OS\nUpdateSummary\n| where TimeGenerated > ago(14d)\n| where CriticalUpdatesMissing != \"0\" \n    and OldestMissingSecurityUpdateInDays > 30\n| summarize Distinct=dcount(Computer) by OsVersion\n| sort by OsVersion",
                  "GridColumnsWidth": {
                    "OsVersion": "260px",
                    "count_": "253px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "27": {
            "position": {
              "x": 5,
              "y": 30,
              "colSpan": 5,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "
                  }
                },
                {
                  "name": "Query",
                  "value": "Update\r\n| where UpdateState == \"Needed\"\r\n    and iff(isnotnull(toint(Optional)), Optional == false, Optional == \"false\") == true\r\n    and Classification == \"Security Updates\"\r\n    and iff(isnotnull(toint(Approved)), Approved != false, Approved != \"false\") == true\r\n| summarize count() by Product\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P7D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Product",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/
                },
                {
                  "name": "PartId",
                  "value": "535eda3f-75b1-4ba3-977d-73a1ca4ad3c4"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Missing Security Updates",
                  "PartSubTitle": "Past 7 Days"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "28": {
            "position": {
              "x": 10,
              "y": 30,
              "colSpan": 11,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "
                  }
                },
                {
                  "name": "Query",
                  "value": "ProtectionStatus\r\n| where ScanDate < now(-7d)\r\n| project DeviceName, TypeofProtection, SignatureVersion, ScanDate\r\n| sort by ScanDate\n"
                },
                {
                  "name": "TimeRange",
                  "value": "2019-01-01T16:02:07.000Z/2019-02-26T16:02:07.081Z"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/
                },
                {
                  "name": "PartId",
                  "value": "7a774335-12e8-4fac-99f7-914397ac39f5"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Hosts that have not been scanned",
                  "PartSubTitle": "Past 7 Days",
                  "GridColumnsWidth": {
                    "DeviceName": "236px",
                    "TypeofProtection": "211px",
                    "SignatureVersion": "171px",
                    "ScanDate": "324px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "7d"
                  }
                }
              }
            }
          },
          "29": {
            "position": {
              "x": 0,
              "y": 34,
              "colSpan": 6,
              "rowSpan": 6
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "S
                  }
                },
                {
                  "name": "Query",
                  "value": "UpdateSummary\r\n| where LastUpdateApplied < now(-30d)\r\n| summarize count(Computer) by OsVersion\n"
                },
                {
                  "name": "TimeRange",
                  "value": "PT4H"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "OsVersion",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "count_Computer",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/s
                },
                {
                  "name": "PartId",
                  "value": "f0e79d0b-cb84-45a8-9e11-3248f645eb20"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "Bar"
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Last Patch Applied (OS Version)",
                  "PartSubTitle": "Greater than 30 Days"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "24h"
                  }
                }
              }
            }
          },
          "30": {
            "position": {
              "x": 6,
              "y": 34,
              "colSpan": 9,
              "rowSpan": 6
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "S
                  }
                },
                {
                  "name": "Query",
                  "value": "let ComputersMissingUpdates3DaysAgo = Update\n| where TimeGenerated between (ago(3d)..ago(2d))\n| where  Classification == \"Critical Updates\" and UpdateState != \"Not needed\" and UpdateState != \"NotNeeded\"\n| summarize makeset(Computer);\nUpdate\n| where TimeGenerated > ago(1d)\n| where  Classification == \"Critical Updates\" and UpdateState != \"Not needed\" and UpdateState != \"NotNeeded\"\n| where Computer in (ComputersMissingUpdates3DaysAgo)\n| where UpdateState == \"Needed\"\n| summarize UniqueUpdatesCount = dcount(Product) by Computer, Title, Product\n//| summarize dcount(Computer) by Product, Computer \n| extend HostCustomEntity = Computer\n| project-away HostCustomEntity\n"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/
                },
                {
                  "name": "PartId",
                  "value": "1f8fc41c-72be-4b62-8d2a-418ddac444cd"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Updates Missing, after Patching Cycle",
                  "PartSubTitle": "Past 3 Days",
                  "GridColumnsWidth": {
                    "Product": "125px",
                    "Computer": "100px",
                    "Title": "457px",
                    "UniqueUpdatesCount": "178px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "3d"
                  }
                }
              }
            }
          },
          "31": {
            "position": {
              "x": 15,
              "y": 34,
              "colSpan": 6,
              "rowSpan": 6
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "
                  }
                },
                {
                  "name": "Query",
                  "value": "UpdateSummary\r\n| where LastUpdateApplied < now(-30d)\r\n//| project Computer , OsVersion , LastUpdateApplied\r\n| summarize count() by  Computer, OsVersion, LastUpdateApplied\r\n| project-away count_\r\n| sort by LastUpdateApplied desc nulls last\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/
                },
                {
                  "name": "PartId",
                  "value": "b649fbc8-fb8e-40a3-aa50-b524a0f2c591"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "aaa-Cloud"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Last Patch Applied (Hosts)",
                  "PartSubTitle": "Greater than 30 Days",
                  "GridColumnsWidth": {
                    "Computer": "168px",
                    "OsVersion": "207px",
                    "LastUpdateApplied": "505px"
                  }
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          }
        }
      }
    },
    "metadata": {
      "model": {
        "timeRange": {
          "value": {
            "relative": {
              "duration": 24,
              "timeUnit": 1
            }
          },
          "type": "MsPortalFx.Composition.Configuration.ValueTypes.TimeRange"
        },
        "filterLocale": {
          "value": "en-us"
        },
        "filters": {
          "value": {
            "MsPortalFx_TimeRange": {
              "model": {
                "format": "utc",
                "granularity": "1h",
                "relative": "24h"
              },
              "displayCache": {
                "name": "UTC Time",
                "value": "Past 24 hours"
              },
              "filteredPartIds": [
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc007",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc009",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc00b",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc00d",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc00f",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc013",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc015",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc017",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc019",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc01d",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc01f",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc021",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc025",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc027",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc029",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc02b",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc02d",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc02f",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc031",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc033",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc035",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc039",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc03b",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc03d",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc03f",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc041",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc043",
                "StartboardPart-AnalyticsPart-3ffe1ef3-aaa1-4446-b3b3-c1fdbe0cc045"
              ]
            }
          }
        }
      }
    }
  },
  "name": "Security Operations Dashboard",
  "type": "Microsoft.Portal/dashboards",
  "location": "INSERT LOCATION",
  "tags": {
    "hidden-title": "Security Operations Dashboard"
  },
  "apiVersion": "2015-08-01-preview"
}
